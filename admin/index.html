<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Henry's Kitchen - Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:opsz,wght@6..96,400..900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              'bodoni': ['"Bodoni Moda"', 'serif'],
              'roboto': ['"Roboto"', 'sans-serif'],
            },
            colors: {
              'colore-uno': '#f7f6f5',
              'colore-due': '#bcb5b1',
              'colore-tre': '#77726c',
              'colore-quattro': '#202123',
              'colore-cinque': '#cb334f',
              'colore-nove': '#821427',
            }
          }
        }
      }
    </script>
    <style>
        body { background-color: #f7f6f5; font-family: 'Roboto', sans-serif; }
        .sidebar-link { @apply flex items-center p-3 my-1 text-gray-200 rounded-lg hover:bg-colore-nove hover:text-white transition-colors duration-200; }
        .sidebar-link.active { @apply bg-colore-cinque text-white; }
        .stat-card { @apply bg-white p-6 rounded-xl shadow-md transition-transform hover:-translate-y-1; }
        .status-select { @apply bg-transparent font-semibold border-none rounded-lg focus:ring-0; }
        .status-select-pending { @apply text-yellow-800; }
        .status-select-confirmed { @apply text-blue-800; }
        .status-select-completed { @apply text-green-800; }
        .status-select-cancelled { @apply text-red-800; }
        #toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
        }
        #toast.show {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -20px);
        }
        #toast.success { background-color: #28a745; }
        #toast.error { background-color: #dc3545; }
    </style>
</head>
<body class="bg-colore-uno text-colore-quattro">

    <div id="auth-overlay" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white p-8 rounded-lg shadow-xl text-center w-full max-w-sm">
            <h2 class="text-2xl font-bodoni mb-4">Admin Access</h2>
            <p class="mb-4 text-colore-tre">Please enter the password to continue.</p>
            <input type="password" id="password-input" class="w-full p-2 border border-gray-300 rounded mb-4 focus:ring-2 focus:ring-colore-cinque focus:border-transparent" placeholder="Password">
            <button id="login-btn" class="w-full bg-colore-cinque text-white py-2 rounded-lg hover:bg-colore-nove transition-colors">Login</button>
            <p id="auth-error" class="text-red-500 text-sm mt-2 hidden">Incorrect password.</p>
        </div>
    </div>

    <div id="app-container" class="hidden">
        <div class="flex h-screen">
            <aside class="w-64 bg-colore-quattro text-white flex-col hidden md:flex">
                <div class="p-6 text-center border-b border-gray-700">
                    <h1 class="text-2xl font-bodoni">Henry's Kitchen</h1>
                    <p class="text-sm text-colore-due">Admin Panel</p>
                </div>
                <nav class="flex-grow p-4">
                    <a href="#dashboard" class="sidebar-link active" data-view="dashboard">
                        <i class="fas fa-tachometer-alt w-8 text-center"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#orders" class="sidebar-link" data-view="orders">
                        <i class="fas fa-receipt w-8 text-center"></i>
                        <span>Orders</span>
                    </a>
                    <a href="#menu" class="sidebar-link" data-view="menu">
                        <i class="fas fa-utensils w-8 text-center"></i>
                        <span>Menu</span>
                    </a>
                    <a href="#reservations" class="sidebar-link opacity-50 cursor-not-allowed" title="Coming Soon" onclick="event.preventDefault()">
                        <i class="fas fa-calendar-check w-8 text-center"></i>
                        <span>Reservations</span>
                    </a>
                </nav>
                <div class="p-4 border-t border-gray-700">
                    <a href="/" target="_blank" class="flex items-center p-3 text-gray-300 hover:text-white transition-colors">
                        <i class="fas fa-sign-out-alt w-8 text-center"></i>
                        <span>View Live Site</span>
                    </a>
                </div>
            </aside>

            <main class="flex-1 flex flex-col">
                 <header class="p-4 bg-white shadow-md flex md:hidden justify-between items-center">
                     <h1 class="text-xl font-bodoni">HK Admin</h1>
                     <button id="mobile-menu-btn" class="text-2xl"><i class="fas fa-bars"></i></button>
                 </header>
                 <div id="view-content" class="flex-1 p-4 sm:p-8 overflow-y-auto">
                    <!-- Views will be rendered here -->
                 </div>
            </main>
        </div>
    </div>
    
    <div id="toast"></div>

    <div id="menu-item-modal" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-lg">
            <h3 id="modal-title" class="text-2xl font-bodoni mb-6">Modal Title</h3>
            <form id="menu-item-form">
                <input type="hidden" id="category-index">
                <input type="hidden" id="item-index">
                <div class="mb-4">
                    <label for="item-name" class="block text-sm font-medium text-gray-700">Name</label>
                    <input type="text" id="item-name" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-colore-cinque focus:border-colore-cinque" required>
                </div>
                <div class="mb-4">
                    <label for="item-description" class="block text-sm font-medium text-gray-700">Description</label>
                    <textarea id="item-description" rows="3" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-colore-cinque focus:border-colore-cinque"></textarea>
                </div>
                <div class="mb-4">
                    <label for="item-price" class="block text-sm font-medium text-gray-700">Price (e.g., $15.00)</label>
                    <input type="text" id="item-price" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-colore-cinque focus:border-colore-cinque" required>
                </div>
                <div class="mb-6">
                    <label for="item-image" class="block text-sm font-medium text-gray-700">Image URL</label>
                    <input type="url" id="item-image" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-colore-cinque focus:border-colore-cinque" required>
                </div>
                <div class="flex justify-end gap-4">
                    <button type="button" id="cancel-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors">Cancel</button>
                    <button type="submit" id="save-btn" class="px-4 py-2 bg-colore-cinque text-white rounded-lg hover:bg-colore-nove transition-colors">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz5m6PuueTv4OcabjS9fabmL3XnRQ_qcwjBavcHRiQjxRY68MXaCxh-EyK243aRVohy/exec';
        const ADMIN_PASSWORD = 'henry2024';

        const menuData = [
            {
                title: "Breads & Soups",
                items: [
                    { id: "b1", name: "HOME MADE BREAD", description: "focaccia with balsamic reduction & extra virgin olive oil, whipped butter", price: "$4.95", priceValue: 4.95, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/bread-1920w.jpg" },
                    { id: "b2", name: "GARLIC BREAD", description: "sliced home made crusty french bread toasted with garlic butter", price: "$4.95", priceValue: 4.95, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/garlic-1920w.jpg" },
                    { id: "b3", name: "PORK RILLETTES AND BREAD", description: "a rustic French pork pâté spread (brown pork jam) with homemade bread", price: "$6.95", priceValue: 6.95, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/pork+pate+bread-1920w.jpg" },
                    { id: "b4", name: "TOMATO CHEESE BREAD", description: "tomato marinaram sauce, mazzarella & parmesan cheese melted on focaccia bread", price: "$8.95", priceValue: 8.95, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/tomato+bread-1920w.jpg" },
                    { id: "s1", name: "FRENCH ONION SOUP", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/onion-soup-ff70c88d-1920w.jpg" },
                    { id: "s2", name: "SEAFOOD CHOWDER", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/chowder-a2521c66-1920w.jpg" },
                    { id: "s3", name: "LOBSTER BISQUE", description: "with lobster arancini", price: "$24.00", priceValue: 24.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/lobster-bisq-1920w.jpg" },
                ]
            },
            {
                title: "Appetizers & Salads",
                items: [
                    { id: "sa1", name: "HOUSE SALAD", description: "spring mix and crisp romaine lettuce tossed with our house dressing and balsamic reduction", price: "(S) $14.95 (L)$16.95", priceValue: 14.95, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/hou.salad-1920w.jpg" },
                    { id: "sa2", name: "CAESAR SALAD", description: "crisp romaine lettuce with homemade Caesar dressing, parmesan cheese and homemade garlic crouton", price: "(S) $14.95 (L)$16.95", priceValue: 14.95, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/ceaser-1920w.jpg" },
                    { id: "sa3", name: "SALMON GRAVLAX", description: "with orange fennel salad", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/samoln+G-1920w.jpg" },
                    { id: "sa4", name: "MUSHROOM FRICASSEE", description: "sautéed assorted mushrooms on baby spinach salad with balsamic reduction & walnuts", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/mushroom-Fri-1920w.jpg" },
                    { id: "sa5", name: "BAKED GOAT CHEESE SALAD", description: "with pistachio crust on spinach, pear & mixed berry salad", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/GOAT-CHEESE-d558f8b1-afba1750-1920w.jpg" },
                    { id: "sa6", name: "BEEF CARPACCIO", description: "Dressed with Dijon mustard, lemon, capers, parmigigiano, truffle oil", price: "$28.00", priceValue: 28.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/beef-carpio-1920w.jpg" },
                ]
            },
            {
                title: "Hot Appetizers",
                items: [
                    { id: "ha1", name: "ESCARGOTS A LAD PARISIENNE", description: "baked snails in a cognac, garlic, & herb butter", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/ecsago-a9f326c4-1920w.jpg" },
                    { id: "ha2", name: "SIGNATURE CRAB CAKE", description: "served on avocado, tomato salsa, mango couils & wasabi aioli", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/carb+cake-1920w.jpg" },
                    { id: "ha3", name: "FROG LEGS FEUILLETTES", description: "sautéed with mushroom & Riesling cream sauce served in a flaky puff pastry", price: "$28.00", priceValue: 28.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/frog+legs-1920w.jpg" },
                    { id: "ha4", name: "ROASTED QUAIL & FOIE GRAS", description: "Roasted quail stuffed with wild rice, mushroom & foie gras, wrapped in prosciutto, served with grapes & walnuts", price: "$28.00", priceValue: 28.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/quail+app-1920w.jpg" },
                    { id: "ha5", name: "CRISP PRAWNS WRAPPED IN ANGEL HAIR", description: "served on carrot raisin salad with mango salsa", price: "$18.00", priceValue: 18.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/crisp-prawns-c7f0c313-1920w.jpg" },
                ]
            },
            {
                title: "The Classic Art of Pasta",
                items: [
                    { id: "p1", name: "PENNE POMODORO", description: "with Italian plum tomatoes and fresh basil", price: "$30.00", priceValue: 30.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/tom-1920w.jpg" },
                    { id: "p2", name: "PENNE ALFREDO", description: "tossed in a rich parmigiano cheese cream sauce", price: "$30.00", priceValue: 30.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/cream-1920w.jpg" },
                    { id: "p3", name: "LINGUINE CARBONARA", description: "with pancetta, parmesan cheese, and custard cream sauce", price: "$32.00", priceValue: 32.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/caro-pasta-1920w.jpg" },
                    { id: "p4", name: "LINGUINE POLLO PESTO", description: "with chicken tossed in fresh basil pesto cream sauce", price: "$32.00", priceValue: 32.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/pesto-1920w.jpg" },
                    { id: "p5", name: "LINGUINE SALMON AFFUMICATO", description: "with smoked salmon and sun-dried tomatoes in a light cream sauce", price: "$35.00", priceValue: 35.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/salmon-pasta-1920w.jpg" },
                    { id: "p6", name: "LINGUINE AGLIO OLIO", description: "with garlic, chili, white wine, butter, basil, parsley, and extra virgin olive oil", price: "$30.00", priceValue: 30.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/aliolo-6d7b7ab1-1920w.jpg" },
                    { id: "p7", name: "LINGUINE AMATRICIANA", description: "with pancetta, garlic, shallot, chili, spicy tomatoes sauce", price: "$32.00", priceValue: 32.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/AM-8032bb9b-1920w.jpg" },
                    { id: "p8", name: "LINGUINE SALSICCIA", description: "with sautéed Italian sausage in spicy tomato sauce", price: "$32.00", priceValue: 32.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/sausage-1920w.jpg" },
                    { id: "p9", name: "LINGUINE PESCATORA", description: "with mussels, prawns, scallops, clams, and calamari in spicy tomato sauce", price: "$35.00", priceValue: 35.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/seafood+pasta-1920w.jpg" },
                    { id: "p10", name: "LINGUINE VONGOLE", description: "with clam in garlic, chili, white wine & extra virgin olive oil", price: "$35.00", priceValue: 35.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/clam-1920w.jpg" },
                    { id: "p11", name: "LINGUINE GAMBERONI", description: "with sautéed prawns in tomato Rosé sauce", price: "$35.00", priceValue: 35.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/ling+PARWNS-1920w.jpg" },
                    { id: "p12", name: "RISOTTO FUNGHI", description: "with a medley of portobellini, shiitake & shimeji mushroom, aromatics with truffle oil", price: "$35.00", priceValue: 35.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/RISOTO-funghi-1920w.jpg" },
                    { id: "p13", name: "RISOTTO DUCK", description: "smoked Duck Breast with artichokes, sun dried tomatoes, peas and parmigiano cheese", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/risoto-duck-1920w.jpg" },
                ]
            },
            {
                title: "Chef's Recommendations",
                items: [
                    { id: "cr1", name: "BOUILLABAISSE MARSEILLAISE", description: "A medley of fish & shell fish cooked in aromatic fish soup served with rouille sauce & garlic crouton", price: "$68.00", priceValue: 68.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/bouiabsa-6c0226f0-1920w.jpg" },
                    { id: "cr2", name: "PAN-SEARED RED SNAPPER", description: "mushroom vermouth sauce", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/snapper-1920w.jpg" },
                    { id: "cr3", name: "BAKED BLACK SABLE FISH", description: "with Olive Tapende, Tomato confit, capers and lemon infused olive oil", price: "$48.00", priceValue: 48.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/sable-1920w.jpg" },
                ]
            },
            {
                title: "Henry's Specialties",
                items: [
                    { id: "hs1", name: "BEEF BOURGUIGNON", description: "braised beef shank in a tasty rich burgundy wine with mushrooms & onions and served on herb risotto & vegetables", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/beef+stew-1920w.jpg" },
                    { id: "hs2", name: "DUCK BREAST", description: "roasted to your preference in a Grand Marnier orange sauce", price: "$42.00", priceValue: 42.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/duck+brest-1920w.jpg" },
                    { id: "hs3", name: "BEEF WELLINGTON", description: "tenderloin of beef wrapped with prosciutto, foie gras purée, mushroom & truffle duxelle, baked in a flaky puff pastry", price: "$65.00", priceValue: 65.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/wellington-1920w.jpg" },
                    { id: "hs4", name: "RACK OF LAMB", description: "with a Provençale herbs crust and rosemary jus", price: "$65.00", priceValue: 65.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/lamb-1920w.jpg" },
                    { id: "hs5", name: "PORK MEDALLION", description: "with caramelized apple & blue cheese", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/pork+cut-1920w.jpg" },
                    { id: "hs6", name: "ROAST CHICKEN", description: "succulent boneless free range chicken marinated in lemon garlic & rosemary roasted to perfection", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/roast+chix-585accf2-1920w.jpg" },
                    { id: "hs7", name: "ROASTED RABBIT SADDLE ROULADE", description: "wrapped with proscuitto and wild morel mushroom", price: "$45.00", priceValue: 45.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/rabbit-1920w.jpg" },
                    { id: "hs8", name: "PORK KNUCKLE", description: "Roasted cracking pork hock with sauerkrout", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/pork-Kn-1920w.jpg" },
                    { id: "hs9", name: "VEAL T-BONE", description: "Grilled Veal T-Bone rubbed with garlic, lemon juice rosemary & ex virgin olive oil, jus de viande", price: "$48.00", priceValue: 48.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/T+bone-2f1e27c1-1920w.jpg" },
                    { id: "hs10", name: "CASSOULET TOULOUSE", description: "A hearty french bean stew, baked with duck confit, sausage, and pork", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/casslout+2-1920w.jpg" },
                    { id: "hs11", name: "DUCK CONFIT PERIGOURDINE", description: "Traditional slow cooked duck leg with sauteed mushroom, foie gars mousse madeira wine & truffle jus", price: "$38.00", priceValue: 38.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/DUCK+CONFIT-d1436af0-1920w.jpg" },
                ]
            },
            {
                title: "Homemade Desserts",
                items: [
                    { id: "d1", name: "SIGNATURE CHEESE CAKE", description: "with brandied blueberries", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/cheese+cake-1920w.jpg" },
                    { id: "d2", name: "CHOCOLATE GANACHE", description: "Kahlua and chocolate mousse glazed with shiny ganache", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/chcoc-cake-1920w.jpg" },
                    { id: "d3", name: "CRÈME BRULÉE", description: "(Not available for take-out) crisp caramelized vanilla cream custard with berries", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/crebe-4c7616e9-1920w.jpg" },
                    { id: "d4", name: "LEMON TART", description: "with meringue and berries", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/lomon+t-1920w.jpg" },
                    { id: "d5", name: "FRUITS SHERBET", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/SHERBET-6ccd5d65-1920w.jpg" },
                    { id: "d6", name: "NOUGAT GLACEE", description: "nougat ice cream with almond, pistachios", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/ice+cream+2-1920w.jpg" },
                ]
            },
            {
                title: "Coffee & Tea",
                items: [
                    { id: "ct1", name: "COFFEE", price: "$6.00", priceValue: 6.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/coffee-b6505900-1920w.jpg" },
                    { id: "ct2", name: "TEA", price: "$6.00", priceValue: 6.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/tea-1920w.jpg" },
                    { id: "ct3", name: "LATTE", price: "$6.00", priceValue: 6.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/latte-fde0fdcf-1920w.jpg" },
                    { id: "ct4", name: "ESPRESSO", price: "$6.00", priceValue: 6.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/espso-e73c4940-1920w.jpg" },
                    { id: "ct5", name: "AMERICANO", price: "$6.00", priceValue: 6.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/amico-8087362e-1920w.jpg" },
                    { id: "ct6", name: "CAPUCCINO", price: "$6.50", priceValue: 6.50, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/cappio-86361fdc-1920w.jpg" },
                    { id: "ct7", name: "ICED COFFEE", price: "$6.00", priceValue: 6.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/ice-coffee-1920w.jpg" },
                ]
            },
            {
                title: "Specialty Coffee/Tea",
                items: [
                    { id: "sct1", name: "BLUEBERRY TEA", description: "amaretto Grand Mariner", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/bluetea-5afb2fb9-f0e9d2f8-1920w.jpg" },
                    { id: "sct2", name: "MONTE CRISTO", description: "Kahlua, Grand Mariner, whipped cream", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/irish-coffee-1920w.jpg" },
                    { id: "sct3", name: "SPANISH", description: "Kahlua, brandy", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/irish-coffee-1920w.jpg" },
                    { id: "sct4", name: "IRISH", description: "whiskey, whipped cream", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/irish-coffee-1920w.jpg" },
                    { id: "sct5", name: "TUSCAN", description: "sambuca, Baileys", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/irish-coffee-1920w.jpg" },
                    { id: "sct6", name: "ITALIAN", description: "amaretto, Baileys", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/irish-coffee-1920w.jpg" },
                    { id: "sct7", name: "B-52", description: "Kahlua, Baileys, Grand Mariner", price: "$15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/irish-coffee-1920w.jpg" },
                ]
            },
            {
                title: "Wine List",
                items: [
                    { id: "w1", name: "HOUSE RED (LE VILLAGEOIS)", description: "FRANCE (DRY)", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/HOUSE.RED-1920w.jpg" },
                    { id: "w2", name: "HOUSE RED (SANGIOVESE)", description: "GIACONDI ITALY (DRY)", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/SANGIO-cb3f8e5f-1920w.jpg" },
                    { id: "w3", name: "SHIRAZ BIN 555", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/555-f494f53e-08b89368-1920w.jpg" },
                    { id: "w4", name: "PINOT NOIR", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/chianti-1920w.jpg" },
                    { id: "w5", name: "CHIANTI", description: "GABBIANO ITALY", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/chianti-1920w.jpg" },
                    { id: "w6", name: "CÔTES DU RHÔNE", description: "FRANCE", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/cote-9a70d986-1920w.jpg" },
                    { id: "w7", name: "MERLOT", description: "SANDHILL BC", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/sandhill-259eaa5e-1920w.jpg" },
                    { id: "w8", name: "MERLOT-CAB", description: "FRANCE", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/JP-Merlot-cab-1920w.jpg" },
                    { id: "w10", name: "HOUSE WHITE (HOCHTALER)", description: "B.C. (DRY)", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/HOCHT-1920w.jpg" },
                    { id: "w12", name: "GEWÜZTRAMINER", description: "PFAFFENHEIM FRANCE", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/gew-e80e0a27-1920w.jpg" },
                    { id: "w13", name: "RIESLING", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/oysterbay-37dd48ea-1920w.jpg" },
                    { id: "w14", name: "SAUVIGNON BLANC", description: "MISSION HILL RESERVE BC", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/oysterbay-37dd48ea-1920w.jpg" },
                    { id: "w15", name: "PINOT GRIS", description: "PFAFFENHEIM", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/pinot-fris-1920w.jpg" },
                    { id: "w17", name: "PINOT GRIGIO", description: "MASI ITALY", price: "(8OZ) $15.00", priceValue: 15.00, image: "https://lirp.cdn-website.com/0015f2f5/dms3rep/multi/opt/masi-white-1920w.jpg" },
                ]
            },
        ];

        const app = {
            state: {
                orders: [],
                filteredOrders: [],
                view: 'dashboard',
            },

            init() {
                this.cacheDOMElements();
                this.setupEventListeners();
                this.checkAuth();
            },

            cacheDOMElements() {
                this.dom = {
                    authOverlay: document.getElementById('auth-overlay'),
                    passwordInput: document.getElementById('password-input'),
                    loginBtn: document.getElementById('login-btn'),
                    authError: document.getElementById('auth-error'),
                    appContainer: document.getElementById('app-container'),
                    viewContent: document.getElementById('view-content'),
                    sidebarLinks: document.querySelectorAll('.sidebar-link'),
                    toast: document.getElementById('toast'),
                    mobileMenuBtn: document.getElementById('mobile-menu-btn'),
                    menuItemModal: document.getElementById('menu-item-modal'),
                    menuItemForm: document.getElementById('menu-item-form'),
                    modalTitle: document.getElementById('modal-title'),
                    cancelBtn: document.getElementById('cancel-btn'),
                };
            },

            setupEventListeners() {
                this.dom.loginBtn.addEventListener('click', () => this.handleLogin());
                this.dom.passwordInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.handleLogin();
                });

                window.addEventListener('hashchange', () => this.handleRouteChange());
                this.dom.sidebarLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                         if (link.classList.contains('cursor-not-allowed')) {
                             e.preventDefault();
                             return;
                         }
                    });
                });
                
                this.dom.cancelBtn.addEventListener('click', () => this.closeMenuModal());
                this.dom.menuItemForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveMenuItem();
                });
            },

            checkAuth() {
                if (sessionStorage.getItem('hk_admin_auth') === 'true') {
                    this.dom.authOverlay.style.display = 'none';
                    this.dom.appContainer.style.display = 'block';
                    this.handleRouteChange();
                    if (!this.state.orders.length) {
                        this.api.fetchOrders();
                    }
                }
            },

            handleLogin() {
                if (this.dom.passwordInput.value === ADMIN_PASSWORD) {
                    sessionStorage.setItem('hk_admin_auth', 'true');
                    this.checkAuth();
                } else {
                    this.dom.authError.style.display = 'block';
                    this.dom.passwordInput.focus();
                }
            },

            handleRouteChange() {
                const hash = window.location.hash.replace('#', '') || 'dashboard';
                this.state.view = hash;
                this.render();
            },

            showToast(message, type = 'success') {
                this.dom.toast.textContent = message;
                this.dom.toast.className = type;
                this.dom.toast.classList.add('show');
                setTimeout(() => {
                    this.dom.toast.classList.remove('show');
                }, 3000);
            },
            
            formatDate(dateString) {
                if (!dateString) return 'N/A';
                try {
                    return new Date(dateString).toLocaleString('en-US', { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true });
                } catch (e) { return dateString; }
            },

            render() {
                this.dom.sidebarLinks.forEach(link => {
                    link.classList.toggle('active', link.dataset.view === this.state.view);
                });

                switch (this.state.view) {
                    case 'orders':
                        this.renderOrdersView();
                        break;
                    case 'menu':
                        this.renderMenuView();
                        break;
                    case 'dashboard':
                    default:
                        this.renderDashboardView();
                        break;
                }
            },

            renderDashboardView() {
                if (!this.state.orders.length) {
                    this.dom.viewContent.innerHTML = `<div class="text-center p-10"><i class="fas fa-spinner fa-spin text-3xl"></i></div>`;
                    return;
                }
                const totalRevenue = this.state.orders.reduce((sum, order) => sum + (Number(order['Total Amount']) || 0), 0);
                const pendingOrders = this.state.orders.filter(o => (o.Status || 'Pending').toLowerCase() === 'pending').length;
                const recentOrders = this.state.orders.slice(0, 5);

                const recentOrdersHtml = recentOrders.map(order => `
                    <tr class="border-b">
                        <td class="p-3 font-medium">${order['Order ID']}</td>
                        <td class="p-3">${order['Customer Name']}</td>
                        <td class="p-3 font-semibold text-right">$${Number(order['Total Amount']).toFixed(2)}</td>
                        <td class="p-3 text-right"><span class="status-badge status-${(order.Status || 'Pending').toLowerCase()}">${order.Status || 'Pending'}</span></td>
                    </tr>
                `).join('');

                this.dom.viewContent.innerHTML = `
                    <h2 class="text-3xl font-bodoni mb-6">Dashboard</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="stat-card">
                            <h3 class="text-colore-tre">Total Revenue</h3>
                            <p class="text-3xl font-bold mt-2">$${totalRevenue.toFixed(2)}</p>
                        </div>
                        <div class="stat-card">
                            <h3 class="text-colore-tre">Total Orders</h3>
                            <p class="text-3xl font-bold mt-2">${this.state.orders.length}</p>
                        </div>
                        <div class="stat-card">
                            <h3 class="text-colore-tre">Pending Orders</h3>
                            <p class="text-3xl font-bold mt-2">${pendingOrders}</p>
                        </div>
                    </div>
                    <h3 class="text-2xl font-bodoni mb-4">Recent Orders</h3>
                    <div class="bg-white rounded-xl shadow-md overflow-hidden">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-3 text-left font-semibold">Order ID</th>
                                    <th class="p-3 text-left font-semibold">Customer</th>
                                    <th class="p-3 text-right font-semibold">Total</th>
                                    <th class="p-3 text-right font-semibold">Status</th>
                                </tr>
                            </thead>
                            <tbody>${recentOrdersHtml}</tbody>
                        </table>
                    </div>
                `;
            },

            openMenuModal(categoryIndex, itemIndex = null) {
                const form = this.dom.menuItemForm;
                form.reset();
                form.elements['category-index'].value = categoryIndex;
                
                if (itemIndex !== null) {
                    this.dom.modalTitle.textContent = 'Edit Menu Item';
                    const item = menuData[categoryIndex].items[itemIndex];
                    form.elements['item-index'].value = itemIndex;
                    form.elements['item-name'].value = item.name;
                    form.elements['item-description'].value = item.description || '';
                    form.elements['item-price'].value = item.price;
                    form.elements['item-image'].value = item.image;
                } else {
                    this.dom.modalTitle.textContent = 'Add New Menu Item';
                    form.elements['item-index'].value = '';
                }
                
                this.dom.menuItemModal.classList.remove('hidden');
            },

            closeMenuModal() {
                this.dom.menuItemModal.classList.add('hidden');
            },

            saveMenuItem() {
                const form = this.dom.menuItemForm;
                const categoryIndex = form.elements['category-index'].value;
                const itemIndex = form.elements['item-index'].value;
                
                const newItemData = {
                    id: `i${Date.now()}`,
                    name: form.elements['item-name'].value,
                    description: form.elements['item-description'].value,
                    price: form.elements['item-price'].value,
                    priceValue: parseFloat(form.elements['item-price'].value.replace(/[^0-9.-]+/g,"")) || 0,
                    image: form.elements['item-image'].value
                };

                if (itemIndex) {
                    const originalId = menuData[categoryIndex].items[itemIndex].id;
                    menuData[categoryIndex].items[itemIndex] = { ...newItemData, id: originalId };
                    this.showToast('Item updated successfully!', 'success');
                } else {
                    menuData[categoryIndex].items.push(newItemData);
                    this.showToast('Item added successfully!', 'success');
                }

                this.closeMenuModal();
                this.renderMenuView();
            },

            deleteMenuItem(categoryIndex, itemIndex) {
                if (confirm('Are you sure you want to delete this item?')) {
                    const itemName = menuData[categoryIndex].items[itemIndex].name;
                    menuData[categoryIndex].items.splice(itemIndex, 1);
                    this.showToast(`'${itemName}' was deleted.`, 'success');
                    this.renderMenuView();
                }
            },

            renderMenuView() {
                const menuHtml = menuData.map((category, categoryIndex) => `
                    <div class="mb-12">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bodoni border-b-2 border-colore-cinque pb-2">${category.title}</h3>
                            <button class="add-item-btn bg-colore-cinque text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-colore-nove" data-category-index="${categoryIndex}">
                                <i class="fas fa-plus mr-2"></i>Add Item
                            </button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                            ${category.items.map((item, itemIndex) => `
                                <div class="bg-white rounded-lg shadow-md overflow-hidden flex flex-col">
                                    <img src="${item.image}" alt="${item.name}" class="w-full h-48 object-cover">
                                    <div class="p-4 flex flex-col flex-grow">
                                        <h4 class="font-bold text-lg">${item.name}</h4>
                                        <p class="text-sm text-colore-tre my-2 flex-grow">${item.description || ''}</p>
                                        <div class="flex justify-between items-center mt-auto pt-2 border-t mt-2">
                                            <span class="font-semibold text-colore-cinque">${item.price}</span>
                                            <div class="flex items-center">
                                                 <button class="edit-item-btn text-gray-500 hover:text-blue-600 p-2" title="Edit Item" data-category-index="${categoryIndex}" data-item-index="${itemIndex}"><i class="fas fa-pencil-alt"></i></button>
                                                 <button class="delete-item-btn text-gray-500 hover:text-red-600 p-2" title="Delete Item" data-category-index="${categoryIndex}" data-item-index="${itemIndex}"><i class="fas fa-trash-alt"></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');

                this.dom.viewContent.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bodoni">Menu Management</h2>
                        <button class="bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold hover:bg-black cursor-not-allowed" disabled title="Coming Soon">
                            Manage Categories
                        </button>
                    </div>
                    ${menuHtml}
                `;

                this.dom.viewContent.querySelectorAll('.add-item-btn').forEach(btn => {
                    btn.addEventListener('click', e => this.openMenuModal(e.currentTarget.dataset.categoryIndex));
                });
                this.dom.viewContent.querySelectorAll('.edit-item-btn').forEach(btn => {
                    const { categoryIndex, itemIndex } = btn.dataset;
                    btn.addEventListener('click', () => this.openMenuModal(categoryIndex, itemIndex));
                });
                this.dom.viewContent.querySelectorAll('.delete-item-btn').forEach(btn => {
                    const { categoryIndex, itemIndex } = btn.dataset;
                    btn.addEventListener('click', () => this.deleteMenuItem(categoryIndex, itemIndex));
                });
            },
            
            renderOrdersView() {
                const ordersHtml = (this.state.filteredOrders || this.state.orders).map(order => {
                    const status = (order.Status || 'Pending').toLowerCase();
                    const statusOptions = ['Pending', 'Confirmed', 'Completed', 'Cancelled']
                        .map(s => `<option value="${s}" ${s.toLowerCase() === status ? 'selected' : ''}>${s}</option>`).join('');

                    return `
                        <tr class="border-b hover:bg-gray-50">
                            <td class="p-4 font-medium">${order['Order ID']}</td>
                            <td class="p-4">
                                <div class="font-semibold">${order['Customer Name']}</div>
                                <div class="text-xs text-gray-500">${order['Email']}</div>
                                <div class="text-xs text-gray-500">${order['Phone']}</div>
                            </td>
                            <td class="p-4">${this.formatDate(order['Pickup Time'])}</td>
                            <td class="p-4 text-xs">${(order['Order Items'] || '').split('; ').join('<br>')}</td>
                            <td class="p-4 font-bold text-right">$${Number(order['Total Amount']).toFixed(2)}</td>
                            <td class="p-4">
                                <select class="status-select status-select-${status}" data-order-id="${order['Order ID']}">
                                    ${statusOptions}
                                </select>
                            </td>
                        </tr>
                    `
                }).join('');

                this.dom.viewContent.innerHTML = `
                    <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
                        <h2 class="text-3xl font-bodoni">Orders</h2>
                        <input type="text" id="search-orders" class="p-2 border border-gray-300 rounded-lg w-full sm:w-64" placeholder="Search by name or ID...">
                    </div>
                    <div class="bg-white rounded-xl shadow-md overflow-x-auto">
                        <table class="w-full text-sm whitespace-nowrap">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left font-semibold">Order ID</th>
                                    <th class="p-4 text-left font-semibold">Customer</th>
                                    <th class="p-4 text-left font-semibold">Pickup Time</th>
                                    <th class="p-4 text-left font-semibold">Items</th>
                                    <th class="p-4 text-right font-semibold">Total</th>
                                    <th class="p-4 text-left font-semibold">Status</th>
                                </tr>
                            </thead>
                            <tbody>${!this.state.orders.length ? `<tr><td colspan="6" class="p-8 text-center text-gray-500">No orders found.</td></tr>` : ordersHtml}</tbody>
                        </table>
                    </div>
                `;
                
                document.getElementById('search-orders').addEventListener('input', (e) => this.handleSearch(e.target.value));
                this.dom.viewContent.querySelectorAll('.status-select').forEach(sel => {
                    sel.addEventListener('change', (e) => {
                        const newStatus = e.target.value;
                        const orderId = e.target.dataset.orderId;
                        this.api.updateOrderStatus(orderId, newStatus);
                        e.target.className = `status-select status-select-${newStatus.toLowerCase()}`;
                    });
                });
            },

            handleSearch(query) {
                const lowerQuery = query.toLowerCase();
                this.state.filteredOrders = this.state.orders.filter(order => {
                    return order['Customer Name']?.toLowerCase().includes(lowerQuery) ||
                           order['Order ID']?.toLowerCase().includes(lowerQuery);
                });
                this.renderOrdersView();
            },

            api: {
                async fetchOrders() {
                    try {
                        const response = await fetch(`${SCRIPT_URL}?action=getOrders`);
                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                        const result = await response.json();
                        if (result.status === 'error') throw new Error(result.message);
                        app.state.orders = result.data;
                        app.state.filteredOrders = result.data;
                        app.render();
                    } catch (e) {
                        app.showToast(`Error fetching orders: ${e.message}`, 'error');
                    }
                },

                async updateOrderStatus(orderId, newStatus) {
                    try {
                        const formData = new FormData();
                        formData.append('action', 'updateStatus');
                        formData.append('orderId', orderId);
                        formData.append('status', newStatus);

                        const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                        const result = await response.json();
                        if (result.status === 'error') throw new Error(result.message);
                        
                        const order = app.state.orders.find(o => o['Order ID'] === orderId);
                        if (order) order.Status = newStatus;
                        
                        app.showToast(`Order ${orderId} updated to ${newStatus}`, 'success');
                    } catch (e) {
                        app.showToast(`Failed to update order: ${e.message}`, 'error');
                        this.fetchOrders();
                    }
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => app.init());
    </script>
</body>
</html>